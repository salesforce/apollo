databaseChangeLog:
-  preConditions:
   -  runningAs:
         username: apollo
-  changeSet:
      id: 1
      author: hhildebrand
      changes:
      -  sql:
            splitStatements: true
            sql: SET BINARY_COLLATION UNSIGNED
      -  createTable:
            tableName: dag
            columns:
            -  column:
                  name: hash
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: data
                  type: BINARY
            -  column:
                  name: finalized
                  type: BOOLEAN
            -  column:
                  name: chit
                  type: INT
            -  column:
                  name: confidence
                  type: INT
            -  column:
                  name: conflictSet
                  type: BINARY(32)
            -  column:
                  name: discovered
                  type: TIMESTAMP
            -  column:
                  name: noOp
                  type: BOOLEAN
      -  addDefaultValue:
            columnDataType: BOOLEAN
            columnName: finalized
            defaultValueBoolean: false
            tableName: dag
      -  addDefaultValue:
            columnDataType: INT
            columnName: chit
            defaultValue: 0
            tableName: dag
      -  addDefaultValue:
            columnDataType: INT
            columnName: confidence
            defaultValue: 0
            tableName: dag
      -  addUniqueConstraint:
            tableName: dag
            columnNames: hash
            constraintName: dag_unique_hash
            deferrable: false
            disabled: false
            initiallyDeferred: false
      -  createIndex:
            columns:
            -  column:
                  name: finalized
                  type: BOOLEAN
            indexName: idx_dag_finalized
            tableName: dag
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: noOp
                  type: BOOLEAN
            indexName: idx_dag_noOp
            tableName: dag
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: conflictSet
                  type: BINARY(32)
            indexName: idx_dag_conflictSet
            tableName: dag
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: discovered
                  type: TIMESTAMP
            indexName: idx_dag_discovered
            tableName: dag
            unique: false
      -  addDefaultValue:
            columnDataType: BOOLEAN
            columnName: noOp
            defaultValueBoolean: false
            tableName: dag
      -  addDefaultValue:
            columnDataType: TIMESTAMP
            columnName: discovered
            defaultValueComputed: CURRENT_TIMESTAMP
            tableName: dag
      -  createTable:
            tableName: unfinalized
            columns:
            -  column:
                  name: hash
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: data
                  type: BINARY
            -  column:
                  name: finalized
                  type: BOOLEAN
            -  column:
                  name: chit
                  type: INT
            -  column:
                  name: confidence
                  type: INT
            -  column:
                  name: conflictSet
                  type: BINARY(32)
            -  column:
                  name: discovered
                  type: TIMESTAMP
            -  column:
                  name: noOp
                  type: BOOLEAN
      -  addDefaultValue:
            columnDataType: BOOLEAN
            columnName: finalized
            defaultValueBoolean: false
            tableName: unfinalized
      -  addDefaultValue:
            columnDataType: INT
            columnName: chit
            defaultValue: 0
            tableName: unfinalized
      -  addDefaultValue:
            columnDataType: INT
            columnName: confidence
            defaultValue: 0
            tableName: unfinalized
      -  addUniqueConstraint:
            tableName: unfinalized
            columnNames: hash
            constraintName: unfinalized_unique_hash
            deferrable: false
            disabled: false
            initiallyDeferred: false
      -  createIndex:
            columns:
            -  column:
                  name: finalized
                  type: BOOLEAN
            indexName: idx_unfinalized_finalized
            tableName: unfinalized
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: noOp
                  type: BOOLEAN
            indexName: idx_unfinalized_noOp
            tableName: unfinalized
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: conflictSet
                  type: BINARY(32)
            indexName: idx_unfinalized_conflictSet
            tableName: unfinalized
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: discovered
                  type: TIMESTAMP
            indexName: idx_unfinalized_discovered
            tableName: unfinalized
            unique: false
      -  addDefaultValue:
            columnDataType: BOOLEAN
            columnName: noOp
            defaultValueBoolean: false
            tableName: unfinalized
      -  addDefaultValue:
            columnDataType: TIMESTAMP
            columnName: discovered
            defaultValueComputed: CURRENT_TIMESTAMP
            tableName: unfinalized
      -  createTable:
            tableName: unqueried
            columns:
            -  column:
                  name: hash
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: targetRound
                  type: INT
                  autoIncrement: false
                  constraints:
                     nullable: false
      -  addForeignKeyConstraint:
            baseColumnNames: hash
            baseTableName: unqueried
            constraintName: unqueried_dag_ref
            onDelete: CASCADE
            referencedColumnNames: hash
            referencedTableName: dag
      -  addUniqueConstraint:
            tableName: unqueried
            columnNames: hash
            constraintName: unqueried_unique_hash
            deferrable: false
            disabled: false
            initiallyDeferred: false
      -  createIndex:
            columns:
            -  column:
                  name: targetRound
                  type: INT
            indexName: idx_unqueried_target_round
            tableName: unqueried
            unique: false
      -  createTable:
            tableName: link
            columns:
            -  column:
                  name: node
                  type: BINARY(32)
            -  column:
                  name: hash
                  type: BINARY(32)
      -  addForeignKeyConstraint:
            baseColumnNames: node
            baseTableName: link
            constraintName: link_node_ref
            onDelete: CASCADE
            referencedColumnNames: hash
            referencedTableName: dag
      -  createTable:
            tableName: closure
            columns:
            -  column:
                  name: parent
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: child
                  type: BINARY(32)
                  constraints:
                     primaryKey: true
            -  column:
                  name: closure
                  type: BOOLEAN
      -  createIndex:
            columns:
            -  column:
                  name: parent
                  type: BINARY(32)
            indexName: idx_closure_parent
            tableName: closure
            unique: false
      -  createIndex:
            columns:
            -  column:
                  name: child
                  type: BINARY(32)
            indexName: idx_closure_child
            tableName: closure
            unique: false
      -  addForeignKeyConstraint:
            baseColumnNames: parent
            baseTableName: closure
            constraintName: closure_parent_ref
            onDelete: CASCADE
            referencedColumnNames: hash
            referencedTableName: unfinalized
      -  createTable:
            tableName: conflictSet
            columns:
            -  column:
                  name: node
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: preferred
                  type: BINARY(32)
            -  column:
                  name: last
                  type: BINARY(32)
            -  column:
                  name: cardinality
                  type: INT
            -  column:
                  name: counter
                  type: INT
      -  addUniqueConstraint:
            tableName: conflictSet
            columnNames: node
            constraintName: constraint_set_unique
      -  addDefaultValue:
            columnDataType: INT
            columnName: cardinality
            defaultValue: 0
            tableName: conflictSet
      -  addDefaultValue:
            columnDataType: INT
            columnName: counter
            defaultValue: 0
            tableName: conflictSet
      -  addForeignKeyConstraint:
            baseColumnNames: preferred
            baseTableName: conflictSet
            constraintName: conflict_set_preferred_ref
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: hash
            referencedTableName: dag
      -  addUniqueConstraint:
            tableName: conflictSet
            columnNames: node
            constraintName: conflictSet_unique_node
            deferrable: false
            disabled: false
            initiallyDeferred: false
      -  createTable:
            tableName: processors
            columns:
            -  column:
                  name: hash
                  type: BINARY(32)
                  autoIncrement: false
                  constraints:
                     primaryKey: true
            -  column:
                  name: processorClass
                  type: VARCHAR
      -  addForeignKeyConstraint:
            baseColumnNames: hash
            baseTableName: processors
            constraintName: processors_dag_ref
            deferrable: false
            initiallyDeferred: false
            referencedColumnNames: hash
            referencedTableName: dag
      -  addUniqueConstraint:
            tableName: processors
            columnNames: hash
            constraintName: processors_hash_unique